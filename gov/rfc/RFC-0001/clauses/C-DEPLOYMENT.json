{
  "clause_id": "C-DEPLOYMENT",
  "title": "Deployment Strategy",
  "kind": "normative",
  "status": "active",
  "text": "The compiler MUST compile to a Single Source of Truth (SSOT) location and deploy to agent directories.\n\n## SSOT Locations\n\nCompiled skills MUST be stored in one of these SSOT locations:\n- **Project-local SSOT**: `.skillc/runtime/<skill-name>/`\n- **Global SSOT**: `~/.skillc/runtime/<skill-name>/`\n\n## Agent Directories\n\nAgent directories are where AI agents discover skills:\n- `~/.claude/skills/<skill-name>/`\n- `~/.cursor/skills/<skill-name>/`\n\nAgent directories contain links (or copies) pointing to the SSOT location.\n\n## Default Behavior (Local-First)\n\nWhen compiling a **project-local** source (`.skillc/skills/`), the compiler MUST:\n1. Output to project-local SSOT (`.skillc/runtime/<skill-name>/`)\n2. Deploy to agent directory (`~/.claude/skills/<skill-name>/` by default)\n\nWhen compiling a **global** source (`~/.skillc/skills/`), the compiler MUST:\n1. Output to global SSOT (`~/.skillc/runtime/<skill-name>/`)\n2. Deploy to agent directory (`~/.claude/skills/<skill-name>/` by default)\n\n## CLI Flags\n\n| Flag | Default | Effect |\n|------|---------|--------|\n| `--global` | false | Force SSOT to `~/.skillc/runtime/` regardless of source |\n| `--target <agents>` | claude | Which agent directories to deploy to (comma-separated) |\n| `--copy` | false | Force copy instead of symlink/junction |\n| `--force` | false | Overwrite existing skill during import |\n\n## Deployment Methods\n\nThe compiler MUST deploy from SSOT to agent directories using these methods:\n\n1. **Unix**: Create symlink (default)\n2. **Windows**: Create directory junction (no admin required)\n3. **Fallback**: Copy directory contents with warning\n\nThe `--copy` flag forces copy mode on all platforms.\n\n## Deployment Behavior\n\nWhen deploying, the compiler MUST:\n1. Ensure the parent directory exists\n2. Remove any existing symlink/junction at the target path\n3. Create a symlink/junction pointing to the SSOT directory (or copy if `--copy`)\n4. Report each deployment with method used\n\nThe compiler MUST NOT overwrite an existing directory (non-symlink) without `--force`.",
  "since": "0.1.0"
}
