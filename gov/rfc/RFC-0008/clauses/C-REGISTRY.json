{
  "clause_id": "C-REGISTRY",
  "title": "Rule Registry",
  "kind": "normative",
  "status": "active",
  "text": "This clause defines all lint rules. Each rule has an ID, name, default severity, and description.\n\n## Frontmatter Definition\n\nSKILL.md frontmatter is a YAML block delimited by `---` lines:\n- The file MUST begin with a line containing exactly `---`\n- The frontmatter ends at the next line containing exactly `---`\n- Content between the delimiters is parsed as YAML\n\nFrontmatter validation is handled by rule **SKL100**.\n\n## Rule Summary\n\n| Rule ID | Name | Default | Category |\n|---------|------|---------|----------|\n| SKL001 | skip-compiled | n/a | Meta |\n| SKL100 | frontmatter-valid | error | Frontmatter |\n| SKL101 | name-required | error | Frontmatter |\n| SKL102 | name-format | error | Frontmatter |\n| SKL103 | name-length | error | Frontmatter |\n| SKL104 | name-match-dir | warning | Frontmatter |\n| SKL105 | description-required | error | Frontmatter |\n| SKL106 | description-nonempty | error | Frontmatter |\n| SKL107 | description-length | warning | Frontmatter |\n| SKL108 | description-triggers | warning | Frontmatter |\n| SKL109 | frontmatter-known | warning | Frontmatter |\n| SKL201 | skill-size | warning | Structure |\n| SKL202 | heading-h1 | warning | Structure |\n| SKL203 | heading-match-name | warning | Structure |\n| SKL204 | heading-first-h1 | warning | Structure |\n| SKL205 | heading-hierarchy | warning | Structure |\n| SKL301 | link-file-exists | error | Links |\n| SKL302 | link-anchor-exists | warning | Links |\n| SKL303 | link-no-escape | error | Links |\n| SKL401 | no-orphans | warning | Files |\n\n---\n\n## Meta Rules (SKL0xx)\n\n### SKL001: skip-compiled\n\nSkip linting for compiled skills (detected by `.skillc-meta/manifest.json`).\n\n**Default behavior:** enabled (compiled skills are skipped)\n\nWhen a compiled skill is detected and this rule is enabled:\n1. The linter prints: `info: skipping compiled skill '<name>'`\n2. Exits with code 0 (success)\n\nWhen `--force` is used, this rule is disabled and:\n1. The linter emits: `warning[W300]: SKL001 skip-compiled: linting compiled skill; results may not be meaningful`\n2. Applies all other rules normally\n\n**Configurability:** Unlike other rules, SKL001 is controlled by `--force`, not by rule configuration. Future versions MAY allow disabling it via config.\n\n**Rationale:** Compiled skills are derived artifacts. Their generated stub differs from source content.\n\n---\n\n## Frontmatter Rules (SKL1xx)\n\n### SKL100: frontmatter-valid\n\nSKILL.md MUST have valid frontmatter delimiters and parseable YAML.\n\n**Default severity:** error\n\n**Requirements:**\n- File MUST begin with a line containing exactly `---`\n- A second `---` line MUST appear to close the frontmatter\n- Content between delimiters MUST be valid YAML\n\n**Error messages:**\n- Missing opening delimiter: `missing frontmatter: file does not start with ---`\n- Missing closing delimiter: `missing frontmatter: no closing --- found`\n- YAML parse error: `invalid frontmatter YAML: <parse-error>`\n\n### SKL101: name-required\n\nThe `name` field MUST be present in SKILL.md frontmatter.\n\n**Default severity:** error\n\n### SKL102: name-format\n\nThe `name` field MUST contain only lowercase ASCII letters (`a-z`), digits (`0-9`), and hyphens (`-`). It MUST NOT start or end with a hyphen.\n\n**Default severity:** error\n\n**Valid:** `my-skill`, `skill123`, `a`\n**Invalid:** `My-Skill` (uppercase), `-skill` (leading hyphen), `skill_name` (underscore)\n\n### SKL103: name-length\n\nThe `name` field MUST be 1-64 characters in length.\n\n**Default severity:** error\n\n### SKL104: name-match-dir\n\nThe `name` field SHOULD match the skill directory name.\n\n**Default severity:** warning\n\n### SKL105: description-required\n\nThe `description` field MUST be present in SKILL.md frontmatter.\n\n**Default severity:** error\n\n### SKL106: description-nonempty\n\nThe `description` field MUST NOT be empty or whitespace-only.\n\n**Default severity:** error\n\n### SKL107: description-length\n\nThe `description` field SHOULD be at most 1024 characters.\n\n**Default severity:** warning\n\n### SKL108: description-triggers\n\nThe `description` field SHOULD include activation triggers.\n\n**Default severity:** warning\n\n**Detection:** The rule checks for presence of any of these English patterns (case-insensitive):\n- `use when`\n- `when to use`\n- `use for`\n- `triggers on`\n- `triggers:`\n- `activate when`\n\n**Note:** This rule is designed for English-language skills. Non-English skills may disable this rule via configuration (future).\n\n### SKL109: frontmatter-known\n\nFrontmatter fields SHOULD be from the known set.\n\n**Default severity:** warning\n\n**Known fields:**\n- `name` (required)\n- `description` (required)\n- `allowed-tools` (optional, implementation-defined behavior)\n\nUnknown fields trigger a warning. This helps catch typos and misunderstandings of the schema.\n\n**Note on `allowed-tools`:** This field is recognized by some agent implementations to restrict available tools. Its format and semantics are implementation-defined. Future versions MAY add validation rules for this field.\n\n---\n\n## Structure Rules (SKL2xx)\n\n### SKL201: skill-size\n\nSKILL.md SHOULD be at most 500 lines.\n\n**Default severity:** warning\n\n### SKL202: heading-h1\n\nSKILL.md SHOULD contain at least one H1 (`#`) heading.\n\n**Default severity:** warning\n\n### SKL203: heading-match-name\n\nThe first H1 heading in SKILL.md SHOULD match or contain the skill name.\n\n**Default severity:** warning\n\n**Matching:** Case-insensitive comparison. The heading may contain additional text (e.g., heading \"My Skill Guide\" matches name \"my-skill\" if \"my-skill\" appears as a substring after normalizing hyphens to spaces).\n\n### SKL204: heading-first-h1\n\nThe first heading in each markdown file SHOULD be an H1 (`#`).\n\n**Default severity:** warning\n\n**Scope:** Applies to all `.md` files in the skill directory.\n\n**Rationale:** The first heading establishes the document title. Starting with H2 or lower suggests missing context.\n\n*Since: v0.2.0*\n\n### SKL205: heading-hierarchy\n\nHeadings SHOULD NOT skip levels when going deeper.\n\n**Default severity:** warning\n\n**Scope:** Applies to all `.md` files in the skill directory.\n\n**Requirements:**\n- When increasing heading depth, levels MUST NOT be skipped (H2→H4 is invalid; H2→H3 is valid)\n- Decreasing depth is always allowed (H3→H2, H4→H1 are valid)\n\n**Examples:**\n- Valid: `# Title` → `## Section` → `### Subsection` → `## Another Section`\n- Invalid: `# Title` → `### Subsection` (skipped H2)\n- Invalid: `## Section` → `#### Deep` (skipped H3)\n\n**Rationale:** Skipped heading levels break document outline semantics and can cause accessibility issues.\n\n*Since: v0.2.0*\n\n---\n\n## Link Rules (SKL3xx)\n\n### SKL301: link-file-exists\n\nInternal markdown file links MUST resolve to existing files within the skill directory.\n\n**Default severity:** error\n\n**Scope:** Relative links like `[text](path/to/file.md)`. Absolute paths and external URLs are not checked.\n\n### SKL302: link-anchor-exists\n\nInternal markdown anchor links SHOULD resolve to existing headings.\n\n**Default severity:** warning\n\n**Anchor normalization:** GitHub-style slugging for ASCII:\n1. Convert to lowercase\n2. Remove characters except `a-z`, `0-9`, spaces, hyphens\n3. Replace spaces with hyphens\n4. Collapse consecutive hyphens\n\nNon-ASCII characters are removed. For duplicate headings, anchors are suffixed: `#heading`, `#heading-1`.\n\n### SKL303: link-no-escape\n\nLinks MUST NOT escape the skill root directory via `..` traversal.\n\n**Default severity:** error\n\n---\n\n## File Rules (SKL4xx)\n\n### SKL401: no-orphans\n\nMarkdown files in the skill directory SHOULD be reachable from SKILL.md via link traversal.\n\n**Default severity:** warning\n\n**Definition:** A file is orphaned if it is not SKILL.md and is not reachable via links starting from SKILL.md (transitive closure).\n\n**Exceptions:** Not considered orphaned:\n- Files in hidden directories (starting with `.`)\n- Common non-content files: `LICENSE.md`, `CHANGELOG.md`, `CONTRIBUTING.md`, `README.md`",
  "since": "0.1.0"
}
