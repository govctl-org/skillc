{
  "clause_id": "C-CODES",
  "title": "Error Code Table",
  "kind": "normative",
  "status": "active",
  "text": "## Error Codes\n\n**Canonical error code table:**\n\n| Code | Message Template | Semantics |\n|------|------------------|-----------|\n| E001 | `error[E001]: skill '<skill>' not found` | Skill resolution failed (no matching directory in any store) |\n| E002 | `error[E002]: search index unusable; run 'skc build <skill>' to rebuild` | Index is missing, corrupt, or stale |\n| E003 | `error[E003]: index hash collision; delete .skillc-meta/search-<hash16>.db and rebuild` | Index filename exists but belongs to different skill |\n| E004 | `error[E004]: empty query` | Search query is empty or whitespace-only |\n| E010 | `error[E010]: not a valid skill: '<path>' (missing SKILL.md)` | Directory exists but lacks SKILL.md |\n| E011 | `error[E011]: missing frontmatter field '<field>' in SKILL.md` | SKILL.md lacks required `name` or `description` field entirely |\n| E012 | `error[E012]: path escapes skill root: '<path>'` | Symlink or path traversal would escape skill directory |\n| E020 | `error[E020]: section not found: '<section>'` | Gateway show command found no matching heading |\n| E021 | `error[E021]: file not found: '<path>'` | Gateway open command target does not exist |\n| E022 | `error[E022]: directory not found: '<path>'` | Gateway sources --dir target does not exist |\n| E030 | `error[E030]: invalid query type: '<type>'` | Stats command received unknown query type |\n| E031 | `error[E031]: invalid filter: '<message>'` | Stats command received malformed filter value |\n| E040 | `error[E040]: no local logs found` | Sync command found no fallback logs to sync |\n| E041 | `error[E041]: sync destination not writable: '<path>'` | Sync command cannot write to primary runtime directory |\n| E042 | `error[E042]: sync source not readable: '<path>'` | Sync command cannot read from fallback log database |\n| E050 | `error[E050]: skill '<skill>' already exists` | Init command target already has SKILL.md |\n| E100 | `error[E100]: invalid option: '<message>'` | CLI parsing failed (unknown flag, missing value, etc.) |\n| E300 | `error[E300]: <rule-id> <rule-name>: <message>` | Lint rule violation with error severity (see [[RFC-0008]]) |\n| E999 | `error[E999]: <message>` | Internal error (IO, database, parsing, or other unexpected failures) |\n\n## Warning Codes\n\n**Canonical warning code table:**\n\n| Code | Message Template | Semantics |\n|------|------------------|-----------|\n| W001 | `warning[W001]: multiple matches for '<section>'; showing first` | Gateway show found multiple headings matching query |\n| W002 | `warning[W002]: logging disabled; run 'skc sync' after session to merge logs` | Access logging failed, using fallback or disabled |\n| W003 | `warning[W003]: stale local logs for '<skill>'; run 'skc sync' to upload` | Local fallback logs exist and are older than threshold |\n| W300 | `warning[W300]: <rule-id> <rule-name>: <message>` | Lint rule violation with warning severity (see [[RFC-0008]]) |\n\n**Warning behavior:**\n\n- Warnings are printed to stderr but do NOT cause command failure\n- Commands that emit warnings still exit with code 0\n- Multiple warnings may be emitted per command invocation\n\n## Resolution error hierarchy\n\nWhen resolving a skill per [[RFC-0007:C-RESOLUTION]]:\n- **E010**: A directory was found (at the given path OR in project/global stores) but it lacks SKILL.md\n- **E001**: No directory was found at the path AND no match in project/global stores\n\nE010 is a more specific form of resolution failure. Use E010 when a directory exists but isn't a valid skill; use E001 when no directory is found at all.\n\n## Lint diagnostics\n\nLint diagnostics (E300, W300) use a structured format that includes the rule ID from [[RFC-0008:C-REGISTRY]]:\n\n```\n<severity>[<code>]: <rule-id> <rule-name>: <message>\n```\n\n**Examples:**\n- `error[E300]: SKL102 name-format: name contains invalid characters`\n- `warning[W300]: SKL108 description-triggers: missing activation trigger`\n- `warning[W300]: SKL401 no-orphans: orphaned file 'old-draft.md'`\n\nThe rule ID (SKLxxx) provides semantic detail; the diagnostic code (E300/W300) indicates severity. This separation allows adding new lint rules without modifying this RFC.\n\n## Unified codes\n\nThe following codes are used across multiple RFCs:\n\n- **E001/E010 (Skill resolution)**: All commands that resolve skills via [[RFC-0007:C-RESOLUTION]] MUST use E001 or E010 when resolution fails.\n- **E002–E004 (Index/query)**: Errors for index state and query validation. Currently used by search; future commands with similar semantics should reuse these.\n- **E012 (Path escape)**: Any command that validates paths MUST use E012 when a path would escape the skill root.\n- **E040–E042 (Sync)**: Errors specific to the sync command for log synchronization.\n- **E050 (Skill exists)**: Init command cannot overwrite existing skill.\n- **E100 (Invalid option)**: All commands MUST use E100 for flag/option parsing failures.\n- **E300/W300 (Lint)**: Skill authoring validation per [[RFC-0008]]. Rule IDs (SKLxxx) provide specifics.\n- **E999 (Internal)**: Unexpected failures (IO errors, database errors, parsing errors). These indicate bugs or environmental issues, not user errors.\n- **W001 (Multiple matches)**: Gateway commands that find multiple matches.\n- **W002 (Logging disabled)**: Access logging encountered errors.\n- **W003 (Stale logs)**: Local fallback logs need syncing.\n\n## Message format\n\nAll diagnostic messages MUST include the code in brackets:\n- Errors: `error[EXXX]: <message>`\n- Warnings: `warning[WXXX]: <message>`\n\nThis format enables:\n- Machine parsing of diagnostic codes\n- Easy searching in documentation\n- Consistent user experience across commands\n\n**Placeholder substitution:**\n- `<skill>` — The skill name/path provided by the user\n- `<path>` — File or directory path\n- `<hash16>` — First 16 characters of SHA-256 hash\n- `<field>` — Frontmatter field name\n- `<section>` — Section heading text\n- `<type>` — Query type string\n- `<message>` — Contextual error details\n- `<rule-id>` — Lint rule identifier (e.g., SKL102)\n- `<rule-name>` — Lint rule name (e.g., name-format)\n\n## Exit behavior\n\n- **Errors**: Exit with status 1\n- **Warnings**: Do not affect exit status (exit 0 if no errors)\n\nImplementations MUST NOT use different exit codes for different error types.\n\n## Adding new codes\n\nNew diagnostic codes MUST be added to this table via RFC amendment. Feature RFCs MUST NOT define new codes inline; they MUST reference this RFC and propose additions here.\n\n**Exception:** Lint rules (SKLxxx) are defined in [[RFC-0008]] and use E300/W300 as their diagnostic codes. Adding new lint rules does not require amending this RFC.\n\n**Reserved ranges:**\n\nError codes:\n- E001–E010: Unified errors (skill resolution, index state, query validation, path safety)\n- E011–E019: Compilation errors (RFC-0001)\n- E020–E029: Gateway errors (RFC-0002)\n- E030–E039: Analytics errors (RFC-0003)\n- E040–E049: Sync errors (RFC-0007)\n- E050–E059: Scaffolding errors (RFC-0006)\n- E100–E199: CLI parsing errors (all commands)\n- E200–E299: Reserved for network/remote errors\n- E300: Lint errors (RFC-0008) — rule IDs provide specifics\n- E999: Internal/unexpected errors\n\nWarning codes:\n- W001–W009: Gateway warnings\n- W010–W019: Logging warnings\n- W020–W029: Reserved for future use\n- W300: Lint warnings (RFC-0008) — rule IDs provide specifics",
  "since": "0.1.0"
}
