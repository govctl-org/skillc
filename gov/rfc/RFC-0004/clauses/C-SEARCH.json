{
  "clause_id": "C-SEARCH",
  "title": "Search Command",
  "kind": "normative",
  "status": "active",
  "text": "**Syntax:** `skc search <skill> <query> [options]`\n\nThe search command MUST query the FTS5 index and return ranked results.\n\n**Options:**\n- `--limit N` — Maximum results (default: 10)\n- `--format <text|json>` — Output format (default: text)\n\n**Ranking:**\nResults MUST be ranked using BM25. Scores MUST be negated for display (FTS5 returns negative).\n\n**Snippet extraction:**\nSnippet parameters (FTS5 `snippet()` function):\n- Column: `content` (index 2)\n- Start marker: `[MATCH]`\n- End marker: `[/MATCH]`\n- Ellipsis: `...`\n- Token limit: `32`\n\n**Output format guarantees:**\n\n**JSON is canonical (Normative).** Use JSON for machine parsing.\n\n**JSON output (`--format json`):**\n```json\n{\n  \"query\": \"<original-query>\",\n  \"results\": [\n    {\n      \"file\": \"<relative-path>\",\n      \"section\": \"<heading-or-identifier>\",\n      \"snippet\": \"...text with [MATCH]term[/MATCH]...\",\n      \"score\": <float>\n    }\n  ]\n}\n```\n\n**Text output (`--format text`) — Informative only:**\nHuman-readable, NOT a stable contract. Do NOT parse.\n\n```\n<file>#<section> (score: <score>)\n  <snippet>\n```\n\n**No results:**\nReturn empty result set, exit 0. JSON: `{\"query\": \"...\", \"results\": []}`.\n\n**Skill resolution:**\nPer [[RFC-0007:C-RESOLUTION]].\n\n**Error handling:**\nAll errors exit with status 1. See [[RFC-0005:C-CODES]] for canonical error messages.\n\n| Condition | Error Code |\n|-----------|------------|\n| Skill resolution failed | E001 or E010 |\n| Index unusable | E002 |\n| Index hash collision | E003 |\n| Empty query | E004 |\n| Invalid CLI option | E100 |\n\nNote: \"Index unusable\" (E002) covers three cases: missing file, corrupt index, or stale metadata. See [[RFC-0004:C-INDEX]] for details.",
  "since": "0.1.0"
}
